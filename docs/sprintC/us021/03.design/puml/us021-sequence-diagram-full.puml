@startuml
skinparam monochrome true
skinparam packageStyle rectangle
skinparam shadowing false

title UI Sequence Diagram (SSD) - Alternative One

autonumber

actor "Green Space Manager" as Employee
participant ":ToDoListUI" as UI
participant ":ToDoListController" as CTRL
participant ":ApplicationSession" as _APP
participant "appSession\n:ApplicationSession" as APP
participant "currentSession\n:UserSession" as SESSAO
participant "responsibleEmail\n:String" as EMAIL
participant ":Repositories" as RepositorySingleton
participant "repositories\n:Repositories" as PLAT
participant "greenSpaceRepository\n:GreenSpaceRepository" as GREENSpaceRepository
participant "greenSpace\n:GreenSpace" as GREEN
participant "listGreenSpace\n:List<GreenSpace>" as listGreenSpace
participant "toDoEntryMapper\n:toDoEntryMapper" as mapper
participant "listGreenSpaceDTO\n: List<GreenSpaceDTO>" as listDTO
participant "objDto\n: greenSpaceDto" as objDto
participant "toDoListRepository\n:toDoListRepository" as toDoListRepository
participant "toDoEntry\n:ToDoEntry" as TODO




activate Employee

    Employee -> UI : ask to add a to-do entry
    activate UI

    UI -> CTRL** : create

    UI -> CTRL : getGreenSpaceDTOByResponsible()
    activate CTRL

    CTRL -> CTRL : getResponsible()
    activate CTRL

                    CTRL -> _APP: getInstance()
                    activate _APP
                        _APP -> CTRL: appSession
                    deactivate _APP


                    CTRL -> APP: getCurrentSession()
                    activate APP

                        APP --> CTRL: currentSession
                    deactivate APP

                    CTRL -> SESSAO: getUserEmail()
                    activate SESSAO

                    deactivate SESSAO
                    deactivate CTRL
                     |||
                    CTRL -> CTRL :getGreenSpacesByResponsible()
                                activate CTRL

                                    CTRL -> GREENSpaceRepository: getGreenSpacesByResponsible(responsibleEmail)
                                    activate GREENSpaceRepository

                                           GREENSpaceRepository -> listGreenSpace** : create
                                           group loop [for each object in the GreenSpaceRepository]

                                                GREENSpaceRepository -> GREENSpaceRepository :  obj = get(i)
                                                activate GREENSpaceRepository
                                                deactivate GREENSpaceRepository

                                                   GREENSpaceRepository -> GREEN : getResponsible()
                                                   activate GREEN
                                                        GREEN -> GREEN : getResponsible()

                                                        GREEN --> GREENSpaceRepository : objResponsible
                                                   deactivate GREEN
                                                group if [objResponsible == responsibleEmail]

                                                   GREENSpaceRepository -> listGreenSpace : add(obj)
                                                   activate listGreenSpace

                                                   deactivate listGreenSpace
                                                end

                                           end

                                        GREENSpaceRepository --> CTRL : listGreenSpaceByResponsible
                                    deactivate GREENSpaceRepository

                                deactivate CTRL
                                |||

                           CTRL -> CTRL : getGreenSpaceDTOByResponsible()
                           activate CTRL

                                CTRL -> mapper** : create
                                CTRL -> mapper : toDto(getGreenSpaceDTOByResponsible())
                                activate mapper

                                    mapper -> listDTO** : create
                                    group loop [for each object in listGreenSpace]
                                        mapper -> listGreenSpace: obj = get(i)
                                        activate listGreenSpace
                                        deactivate listGreenSpace

                                        mapper -> mapper : objDto = toDTO(obj)
                                        activate mapper

                                            mapper --> objDto** : create(obj)
                                        deactivate mapper

                                        mapper -> listDTO : add(objDto)
                                        activate listDTO
                                        deactivate listDTO
                                    end
                                    mapper --> CTRL : listGreenSpaceDto
                                deactivate mapper
                           deactivate CTRL

                           CTRL --> UI : listGreenSpaceDto

                           deactivate CTRL


        UI -> Employee : shows list of green spaces

        Employee -> UI : selects a green space from the list

        UI --> Employee : request data (title, description, urgency, expectedDuration)
    deactivate UI

    Employee -> UI : types requested data

    activate UI

        UI --> Employee : show all data registered\n and the confirmation menu
    deactivate UI

    Employee -> UI : submits data
    activate UI

    UI -> CTRL : registerToDoEntry(greenSpaceID ,title, description, urgency, expectedDuration)
    activate CTRL

    activate CTRL

            CTRL -> CTRL : searchForGreenSpaceID(greenSpaceID)
            activate CTRL

                CTRL -> listGreenSpace: greenSpace  = get(greenSpaceID)
                activate listGreenSpace
                deactivate listGreenSpace


            deactivate CTRL



        CTRL -> RepositorySingleton : getInstance()
        activate RepositorySingleton

        RepositorySingleton --> CTRL: repositories
        deactivate RepositorySingleton

        CTRL -> PLAT : getToDoListRepository()
        activate PLAT

        PLAT --> CTRL: toDoListRepository
        deactivate PLAT

    CTRL -> toDoListRepository** : registerToDoEntry(greenSpace ,title, description, urgency, expectedDuration)
      deactivate CTRL
    activate toDoListRepository

    toDoListRepository -> TODO** : create

    toDoListRepository -> toDoListRepository : addToDoEntry(toDoEntry)

    toDoListRepository -> toDoListRepository : validateToDoEntry(toDoEntry)

    toDoListRepository --> CTRL : toDoEntry
    deactivate toDoListRepository

    CTRL --> UI : toDoEntry
    deactivate CTRL

        UI --> Employee : shows operation (in)success
    deactivate UI

@enduml